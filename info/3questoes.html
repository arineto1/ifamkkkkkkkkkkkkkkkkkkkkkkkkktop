<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulado Técnico: Hardware e Drivers</title>
    <style>
        :root {
            --bg-color: #fdfdfd;
            --text-color: #2c3e50;
            --primary-color: #34495e;
            --accent-color: #2980b9;
            --correct-color: #27ae60;
            --incorrect-color: #c0392b;
            --card-bg: #ffffff;
            --border-color: #e0e0e0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.7;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            width: 100%;
            max-width: 900px;
            padding: 40px 20px;
            text-align: center;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 40px;
        }

        header h1 {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1rem;
            color: #666;
        }

        main {
            width: 100%;
            max-width: 850px;
            padding: 0 20px 60px 20px;
            box-sizing: border-box;
        }

        .question-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }

        .question-number {
            font-weight: bold;
            color: var(--accent-color);
            text-transform: uppercase;
            letter-spacing: 1px;
            display: block;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.15rem;
            margin-bottom: 25px;
            font-weight: 500;
        }

        .options-list {
            list-style: none;
            padding: 0;
        }

        .option-item {
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .option-item:hover {
            background-color: #f8f9fa;
            border-color: var(--accent-color);
        }

        .option-item input {
            margin-right: 15px;
            margin-top: 6px;
            transform: scale(1.2);
        }

        .option-item label {
            cursor: pointer;
            width: 100%;
        }

        /* Classes para o feedback pós-correção */
        .option-item.correct {
            background-color: #d4edda !important;
            border-color: var(--correct-color) !important;
            color: #155724;
        }

        .option-item.incorrect {
            background-color: #f8d7da !important;
            border-color: var(--incorrect-color) !important;
            color: #721c24;
        }

        .btn-container {
            text-align: center;
            margin-top: 20px;
        }

        #submit-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 30px;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            font-weight: bold;
        }

        #submit-btn:hover {
            background-color: #2c3e50;
            transform: translateY(-2px);
        }

        #results-container {
            display: none;
            margin-top: 40px;
            padding: 30px;
            background: #f1f4f8;
            border-radius: 8px;
            text-align: center;
        }

        #results-summary {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .resolution-box {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px dashed #ccc;
            font-size: 0.95rem;
            color: #444;
            background-color: #fcfcfc;
            padding: 15px;
            border-radius: 4px;
        }

        .resolution-box h4 {
            margin-top: 0;
            color: var(--accent-color);
        }

        .highlight-ans {
            font-weight: bold;
            color: var(--correct-color);
        }

        @media (max-width: 600px) {
            header h1 { font-size: 1.5rem; }
            .question-card { padding: 20px; }
        }
    </style>
</head>
<body>

<header>
    <h1>Simulado: Hardware e Drivers de Dispositivo</h1>
    <p>Estilo: Fundação CEFETMINAS | 10 Questões Técnicas</p>
</header>

<main id="quiz-form">
    <div id="questions-container">
        <!-- Questões serão geradas via JS -->
    </div>

    <div class="btn-container">
        <button id="submit-btn" onclick="checkAnswers()">Finalizar Simulado</button>
    </div>

    <div id="results-container">
        <div id="results-summary"></div>
        <p>Role para baixo para conferir a correção e resolução de cada questão.</p>
        <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" style="background:none; border: 1px solid #333; padding: 5px 15px; border-radius: 15px; cursor:pointer;">Voltar ao topo</button>
    </div>
</main>

<script>
    const questionsData = [
        {
            id: 1,
            text: "Em sistemas operacionais modernos baseados na arquitetura de anéis de proteção (Protection Rings) da plataforma x86, a estabilidade do sistema depende intrinsecamente do isolamento entre o código de aplicação e o código de controle de hardware. Considere um cenário em que um driver de vídeo mal escrito tenta acessar um endereço de memória inválido. Analise as afirmativas:\n\nI. A maioria dos drivers de dispositivos de alto desempenho opera no 'Anel 0' (Kernel Mode). Uma violação de acesso resulta em uma parada total do sistema (BSOD ou Kernel Panic).\nII. O 'Modo Usuário' (User Mode / Anel 3) oferece um ambiente isolado. Drivers executados aqui (UMDF) sofrem penalidades de desempenho devido à alternância de contexto.\nIII. Em arquiteturas de microkernel, a maioria dos drivers reside no kernel para velocidade, enquanto em monolíticas busca-se mover os drivers para o usuário para estabilidade.",
            options: [
                "Apenas I.",
                "Apenas I e II.",
                "Apenas II e III.",
                "Apenas I e III.",
                "I, II e III."
            ],
            correct: 1, // B
            resolution: "I está Correta: Drivers no Anel 0 têm acesso total e falhas derrubam o kernel. II está Correta: O modo usuário isola falhas mas gera custo de performance (Context Switching). III está Incorreta: É o inverso; microkernels buscam isolar drivers no usuário para estabilidade, enquanto monolíticos os mantêm no kernel para velocidade."
        },
        {
            id: 2,
            text: "Mecanismo que permite que um subsistema de hardware (como placa de som ou SATA) assuma o controle do barramento para realizar operações de leitura e escrita diretamente na memória RAM, sem intervenção ativa da CPU durante a transferência:",
            options: [
                "Interrupt Request (IRQ) Dedicado.",
                "Direct Memory Access (DMA).",
                "Polling de Alta Frequência.",
                "Hyper-Transport Tunneling.",
                "Memory-Mapped Input/Output (MMIO)."
            ],
            correct: 1, // B
            resolution: "O DMA permite transferir dados entre periféricos e memória RAM de forma autônoma, notificando a CPU via IRQ apenas ao final do processo, liberando o processador para outras tarefas."
        },
        {
            id: 3,
            text: "Sobre o processo de identificação e instalação de drivers em ambiente Windows, assinale a alternativa INCORRETA:",
            options: [
                "O driver de barramento detecta o novo dispositivo e obtém o Hardware ID.",
                "O sistema utiliza o Hardware ID para localizar o arquivo .INF no Driver Store.",
                "Se o driver específico não for encontrado, o Windows tenta carregar um Class Driver genérico.",
                "O arquivo .INF é opcional em instalações modernas, pois o sistema pode baixar e compilar o código fonte do driver da nuvem.",
                "O Gerenciador PnP pode rebalancear recursos do sistema para acomodar novos dispositivos."
            ],
            correct: 3, // D
            resolution: "A alternativa D está INCORRETA porque o arquivo .INF nunca é opcional. Ele contém as instruções de instalação essenciais. O Windows não baixa 'código fonte' para compilar; ele baixa binários (.sys) pré-compilados e scripts de configuração (.inf)."
        },
        {
            id: 4,
            text: "Sobre o gerenciamento de drivers no Linux, avalie:\n\nI. Adota arquitetura de Kernel Monolítico Modular, permitindo carregar funcionalidades (.ko) sem reiniciar.\nII. O comando modprobe é superior ao insmod pois resolve automaticamente as dependências do módulo.\nIII. No diretório /dev, dispositivos de Bloco permitem acesso aleatório (ex: sda) e de Caractere operam como fluxos sequenciais (ex: tty).",
            options: [
                "Todas as afirmativas são verdadeiras.",
                "Apenas I e II são verdadeiras.",
                "Apenas II e III são verdadeiras.",
                "Apenas I e III são verdadeiras.",
                "Apenas I é verdadeira."
            ],
            correct: 0, // A
            resolution: "I. Correto: Linux é monolítico modular. II. Correto: modprobe consulta o arquivo de dependências. III. Correto: Dispositivos de bloco (armazenamento) vs caractere (seriais/terminais) é a distinção padrão Unix/Linux."
        },
        {
            id: 5,
            text: "Preencha as lacunas: 'A assinatura de drivers utiliza criptografia ____ para garantir autenticidade. O desenvolvedor utiliza sua chave ____ para assinar. O sistema utiliza a chave ____ da Autoridade Certificadora para validar. No Windows x64 moderno, drivers não assinados resultam em ____.'",
            options: [
                "simétrica / pública / privada / permissão com aviso.",
                "assimétrica / privada / pública / bloqueio.",
                "de bloco / privada / privada / isolamento em sandbox.",
                "assimétrica / pública / privada / execução em modo de compatibilidade.",
                "de hash / mestra / de sessão / bloqueio."
            ],
            correct: 1, // B
            resolution: "Assinatura digital usa criptografia assimétrica. Assina-se com a chave PRIVADA e valida-se com a PÚBLICA. No Windows x64, a imposição de assinatura de código de kernel (KMCS) bloqueia o carregamento se a assinatura falhar."
        },
        {
            id: 6,
            text: "Qual inovação do modelo WDDM (Windows Display Driver Model) aumentou drasticamente a estabilidade gráfica?",
            options: [
                "Moveu a renderização para a CPU (Software Rasterization).",
                "Introduziu o TDR (Timeout Detection and Recovery) para reiniciar o driver sem resetar o PC.",
                "Exigiu que drivers fossem escritos em Java para evitar vazamentos de memória.",
                "Permitiu acesso exclusivo e direto de cada app aos registradores da GPU.",
                "Removeu o suporte a múltiplos monitores para simplificar a pilha."
            ],
            correct: 1, // B
            resolution: "O TDR permite que o Windows detecte se a GPU parou de responder e reinicie apenas o subsistema gráfico, evitando a 'tela azul' causada por travamentos de drivers de vídeo."
        },
        {
            id: 7,
            text: "Sobre o processo de carga de drivers USB e o uso de Drivers de Classe, é correto afirmar:",
            options: [
                "Sem driver específico VID/PID, o dispositivo é desativado eletricamente.",
                "Drivers de Classe permitem que dispositivos padrão (HID, Mass Storage) funcionem sem software do fabricante.",
                "O carregamento do driver ocorre no firmware do dispositivo periférico.",
                "Drivers USB operam exclusivamente em Polling, consumindo 100% da CPU.",
                "O VID/PID é enviado para o dispositivo USB para programar seu chip."
            ],
            correct: 1, // B
            resolution: "O sistema operacional possui drivers genéricos para classes padronizadas pelo USB-IF. Isso permite que teclados, mouses e pendrives funcionem em 'Plug and Play' universal."
        },
        {
            id: 8,
            text: "Sobre drivers de sistema de arquivos (FSD) e drivers de filtro de armazenamento:",
            options: [
                "FSDs (como ntfs.sys) traduzem solicitações de arquivos em solicitações de blocos lógicos (LBA).",
                "Drivers de antivírus devem ser posicionados na base da pilha, abaixo da controladora física.",
                "O driver de disco (disk.sys) gerencia permissões ACL e estruturas de pastas.",
                "Drivers de armazenamento não utilizam buffer ou cache na RAM por segurança.",
                "Em RAID via software, o driver de sistema de arquivos desaparece."
            ],
            correct: 0, // A
            resolution: "O FSD atua como camada de abstração entre a lógica de arquivos (pastas/nomes) e a lógica de blocos (setores no disco) compreendida pelo hardware."
        },
        {
            id: 9,
            text: "Tecnicamente, o que significa o Código 10 ('This device cannot start') no Gerenciador de Dispositivos?",
            options: [
                "Dispositivo desabilitado administrativamente via GPO.",
                "O driver foi carregado, mas a rotina de início (IRP_MN_START_DEVICE) falhou.",
                "O hardware está fisicamente desconectado ou sem energia.",
                "A data do sistema está incorreta, invalidando o certificado.",
                "Conflito de IRQ exigindo troca para porta PS/2."
            ],
            correct: 1, // B
            resolution: "O Código 10 ocorre quando o driver é carregado com sucesso, mas falha em se comunicar ou inicializar o hardware conforme solicitado pelo Gerenciador PnP."
        },
        {
            id: 10,
            text: "Ao acionar a função 'Reverter Driver' (Roll Back Driver) no Windows, qual ação o sistema executa?",
            options: [
                "Restaura o sistema operacional para o último Ponto de Restauração.",
                "Desinstala o driver atual e reinstala a versão anterior mantida no Driver Store.",
                "Baixa a versão mais recente do site do fabricante.",
                "Força o dispositivo a operar em modo VGA Genérico.",
                "Exclui o arquivo .SYS para forçar uma nova detecção do zero."
            ],
            correct: 1, // B
            resolution: "O Windows mantém cópias de versões anteriores de drivers no FileRepository (Driver Store). Reverter remove o atual e ativa o binário e configurações da versão imediatamente anterior."
        }
    ];

    function renderQuestions() {
        const container = document.getElementById('questions-container');
        questionsData.forEach((q, index) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `q-card-${index}`;

            let optionsHtml = '';
            q.options.forEach((opt, optIndex) => {
                const letter = String.fromCharCode(65 + optIndex); // A, B, C...
                optionsHtml += `
                    <li class="option-item" id="q${index}-opt${optIndex}" onclick="selectOption(${index}, ${optIndex})">
                        <input type="radio" name="question-${index}" value="${optIndex}" id="q${index}-input-${optIndex}">
                        <label for="q${index}-input-${optIndex}"><strong>${letter})</strong> ${opt}</label>
                    </li>
                `;
            });

            card.innerHTML = `
                <span class="question-number">Questão ${index + 1}</span>
                <div class="question-text">${q.text.replace(/\n/g, '<br>')}</div>
                <ul class="options-list">
                    ${optionsHtml}
                </ul>
                <div class="resolution-box" id="res-${index}">
                    <h4>Resolução e Comentário:</h4>
                    <p><span class="highlight-ans">Resposta Correta: ${String.fromCharCode(65 + q.correct)}</span></p>
                    <p>${q.resolution}</p>
                </div>
            `;
            container.appendChild(card);
        });
    }

    function selectOption(qIndex, optIndex) {
        document.getElementById(`q${qIndex}-input-${optIndex}`).checked = true;
    }

    function checkAnswers() {
        let score = 0;
        let answeredCount = 0;

        questionsData.forEach((q, index) => {
            const selected = document.querySelector(`input[name="question-${index}"]:checked`);
            const resolutionBox = document.getElementById(`res-${index}`);
            resolutionBox.style.display = 'block';

            if (selected) {
                answeredCount++;
                const selectedVal = parseInt(selected.value);
                
                // Marcar a correta sempre
                document.getElementById(`q${index}-opt${q.correct}`).classList.add('correct');

                if (selectedVal === q.correct) {
                    score++;
                } else {
                    // Marcar a errada selecionada
                    document.getElementById(`q${index}-opt${selectedVal}`).classList.add('incorrect');
                }
            } else {
                // Se não respondeu, destaca a correta de qualquer forma
                document.getElementById(`q${index}-opt${q.correct}`).classList.add('correct');
            }
        });

        // Mostrar resumo
        const resultsContainer = document.getElementById('results-container');
        const summary = document.getElementById('results-summary');
        resultsContainer.style.display = 'block';
        summary.innerHTML = `Você acertou ${score} de ${questionsData.length} questões!`;
        
        if(score === 10) summary.style.color = 'var(--correct-color)';
        else if(score >= 7) summary.style.color = 'orange';
        else summary.style.color = 'var(--incorrect-color)';

        // Desativar botão e inputs para evitar reenvio
        document.getElementById('submit-btn').disabled = true;
        document.getElementById('submit-btn').style.opacity = '0.5';
        document.getElementById('submit-btn').innerText = 'Simulado Concluído';
        const allInputs = document.querySelectorAll('input[type="radio"]');
        allInputs.forEach(input => input.disabled = true);

        // Scroll suave para o resultado
        resultsContainer.scrollIntoView({ behavior: 'smooth' });
    }

    // Inicializar questões ao carregar
    window.onload = renderQuestions;
</script>

</body>
</html>